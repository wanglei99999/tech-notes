# Linux Memory Cgroup è¯¦è§£

> ğŸ“– å‚è€ƒä¹¦ç±ï¼šã€Šæ·±å…¥ç†è§£ Linux è¿›ç¨‹ä¸å†…å­˜ã€‹
>
> ğŸ¤– ç¬”è®°æ–¹å¼ï¼šé˜…è¯»ä¹¦ç± + AI è¾…åŠ©ç­”ç–‘æ•´ç†
>
> æœ¬æ–‡ä»‹ç» Memory Cgroup çš„åˆ›å»ºã€ç»“æ„ã€é…ç½®å’Œå†…å­˜ç›‘æ§æ–¹æ³•ã€‚

## ç›®å½•

1. [Memory Cgroup ç®€ä»‹](#1-memory-cgroup-ç®€ä»‹)
2. [åˆ›å»º Memory Cgroup](#2-åˆ›å»º-memory-cgroup)
3. [mem_cgroup å†…æ ¸ç»“æ„](#3-mem_cgroup-å†…æ ¸ç»“æ„)
4. [å†…å­˜é™åˆ¶é…ç½®](#4-å†…å­˜é™åˆ¶é…ç½®)
5. [æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ](#5-æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ)

---

## 1. Memory Cgroup ç®€ä»‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Memory Cgroup çš„ä½œç”¨                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   Memory Cgroup ç”¨äºé™åˆ¶å’Œç›‘æ§ä¸€ç»„è¿›ç¨‹çš„å†…å­˜ä½¿ç”¨ï¼š              â”‚
â”‚                                                                 â”‚
â”‚   1. å†…å­˜é™åˆ¶                                                   â”‚
â”‚      â”œâ”€â”€ é™åˆ¶ç‰©ç†å†…å­˜ä½¿ç”¨é‡                                     â”‚
â”‚      â”œâ”€â”€ é™åˆ¶ swap ä½¿ç”¨é‡                                       â”‚
â”‚      â””â”€â”€ é™åˆ¶å†…æ ¸å†…å­˜ä½¿ç”¨é‡                                     â”‚
â”‚                                                                 â”‚
â”‚   2. å†…å­˜ç»Ÿè®¡                                                   â”‚
â”‚      â”œâ”€â”€ ç»Ÿè®¡å½“å‰å†…å­˜ä½¿ç”¨é‡                                     â”‚
â”‚      â”œâ”€â”€ ç»Ÿè®¡å„ç±»å‹å†…å­˜ï¼ˆRSSã€Cacheã€Swap ç­‰ï¼‰                  â”‚
â”‚      â””â”€â”€ ç»Ÿè®¡å†…å­˜äº‹ä»¶ï¼ˆOOMã€å›æ”¶ç­‰ï¼‰                            â”‚
â”‚                                                                 â”‚
â”‚   3. å†…å­˜å›æ”¶                                                   â”‚
â”‚      â”œâ”€â”€ è§¦å‘å†…å­˜å›æ”¶                                           â”‚
â”‚      â””â”€â”€ OOM Killer æ§åˆ¶                                        â”‚
â”‚                                                                 â”‚
â”‚   å…¸å‹åº”ç”¨åœºæ™¯ï¼š                                                â”‚
â”‚   â”œâ”€â”€ å®¹å™¨å†…å­˜éš”ç¦»ï¼ˆDockerã€K8sï¼‰                               â”‚
â”‚   â”œâ”€â”€ é˜²æ­¢å•ä¸ªåº”ç”¨è€—å°½ç³»ç»Ÿå†…å­˜                                  â”‚
â”‚   â””â”€â”€ å¤šç§Ÿæˆ·ç¯å¢ƒçš„èµ„æºéš”ç¦»                                      â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. åˆ›å»º Memory Cgroup

### 2.1 Cgroup v1 åˆ›å»ºæ–¹å¼

```bash
# åœ¨ memory å­ç³»ç»Ÿä¸‹åˆ›å»ºæ§åˆ¶ç»„
mkdir /sys/fs/cgroup/memory/mygroup

# å†…æ ¸è‡ªåŠ¨ç”Ÿæˆçš„æ§åˆ¶æ–‡ä»¶
ls /sys/fs/cgroup/memory/mygroup/
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    v1 Memory Cgroup æ–‡ä»¶                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   /sys/fs/cgroup/memory/mygroup/                                â”‚
â”‚   â”‚                                                             â”‚
â”‚   â”‚   # é™åˆ¶ç›¸å…³                                                â”‚
â”‚   â”œâ”€â”€ memory.limit_in_bytes        # å†…å­˜ç¡¬é™åˆ¶                 â”‚
â”‚   â”œâ”€â”€ memory.soft_limit_in_bytes   # å†…å­˜è½¯é™åˆ¶                 â”‚
â”‚   â”œâ”€â”€ memory.memsw.limit_in_bytes  # å†…å­˜+swap é™åˆ¶             â”‚
â”‚   â”‚                                                             â”‚
â”‚   â”‚   # ä½¿ç”¨é‡ç»Ÿè®¡                                              â”‚
â”‚   â”œâ”€â”€ memory.usage_in_bytes        # å½“å‰å†…å­˜ä½¿ç”¨é‡             â”‚
â”‚   â”œâ”€â”€ memory.memsw.usage_in_bytes  # å†…å­˜+swap ä½¿ç”¨é‡           â”‚
â”‚   â”œâ”€â”€ memory.max_usage_in_bytes    # å†å²æœ€å¤§ä½¿ç”¨é‡             â”‚
â”‚   â”‚                                                             â”‚
â”‚   â”‚   # è¯¦ç»†ç»Ÿè®¡                                                â”‚
â”‚   â”œâ”€â”€ memory.stat                  # è¯¦ç»†å†…å­˜ç»Ÿè®¡               â”‚
â”‚   â”‚                                                             â”‚
â”‚   â”‚   # OOM æ§åˆ¶                                                â”‚
â”‚   â”œâ”€â”€ memory.oom_control           # OOM è¡Œä¸ºæ§åˆ¶               â”‚
â”‚   â”‚                                                             â”‚
â”‚   â”‚   # è¿›ç¨‹ç®¡ç†                                                â”‚
â”‚   â”œâ”€â”€ tasks                        # çº¿ç¨‹åˆ—è¡¨                   â”‚
â”‚   â””â”€â”€ cgroup.procs                 # è¿›ç¨‹åˆ—è¡¨                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Cgroup v2 åˆ›å»ºæ–¹å¼

```bash
# å…ˆå¯ç”¨ memory æ§åˆ¶å™¨
echo "+memory" > /sys/fs/cgroup/cgroup.subtree_control

# åˆ›å»ºæ§åˆ¶ç»„
mkdir /sys/fs/cgroup/mygroup

# æŸ¥çœ‹ç”Ÿæˆçš„æ–‡ä»¶
ls /sys/fs/cgroup/mygroup/
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    v2 Memory Cgroup æ–‡ä»¶                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   /sys/fs/cgroup/mygroup/                                       â”‚
â”‚   â”‚                                                             â”‚
â”‚   â”‚   # é™åˆ¶ç›¸å…³                                                â”‚
â”‚   â”œâ”€â”€ memory.max                   # å†…å­˜ç¡¬é™åˆ¶                 â”‚
â”‚   â”œâ”€â”€ memory.high                  # å†…å­˜è½¯é™åˆ¶ï¼ˆè§¦å‘å›æ”¶ï¼‰     â”‚
â”‚   â”œâ”€â”€ memory.min                   # å†…å­˜ä¿æŠ¤ï¼ˆæœ€ä½ä¿è¯ï¼‰       â”‚
â”‚   â”œâ”€â”€ memory.low                   # å†…å­˜ä¿æŠ¤ï¼ˆå°½é‡ä¿è¯ï¼‰       â”‚
â”‚   â”œâ”€â”€ memory.swap.max              # swap é™åˆ¶                  â”‚
â”‚   â”‚                                                             â”‚
â”‚   â”‚   # ä½¿ç”¨é‡ç»Ÿè®¡                                              â”‚
â”‚   â”œâ”€â”€ memory.current               # å½“å‰å†…å­˜ä½¿ç”¨é‡             â”‚
â”‚   â”œâ”€â”€ memory.swap.current          # å½“å‰ swap ä½¿ç”¨é‡           â”‚
â”‚   â”œâ”€â”€ memory.peak                  # å†å²å³°å€¼                   â”‚
â”‚   â”‚                                                             â”‚
â”‚   â”‚   # è¯¦ç»†ç»Ÿè®¡                                                â”‚
â”‚   â”œâ”€â”€ memory.stat                  # è¯¦ç»†å†…å­˜ç»Ÿè®¡               â”‚
â”‚   â”œâ”€â”€ memory.events                # å†…å­˜äº‹ä»¶ç»Ÿè®¡               â”‚
â”‚   â”‚                                                             â”‚
â”‚   â”‚   # è¿›ç¨‹ç®¡ç†                                                â”‚
â”‚   â””â”€â”€ cgroup.procs                 # è¿›ç¨‹åˆ—è¡¨                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 v1 vs v2 æ–‡ä»¶å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Memory Cgroup æ–‡ä»¶å¯¹æ¯”                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   åŠŸèƒ½              â”‚ Cgroup v1                â”‚ Cgroup v2      â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚   ç¡¬é™åˆ¶            â”‚ memory.limit_in_bytes    â”‚ memory.max     â”‚
â”‚   è½¯é™åˆ¶            â”‚ memory.soft_limit_in_bytesâ”‚ memory.high   â”‚
â”‚   å½“å‰ä½¿ç”¨é‡        â”‚ memory.usage_in_bytes    â”‚ memory.current â”‚
â”‚   swap é™åˆ¶         â”‚ memory.memsw.limit_*     â”‚ memory.swap.maxâ”‚
â”‚   swap ä½¿ç”¨é‡       â”‚ memory.memsw.usage_*     â”‚ memory.swap.currentâ”‚
â”‚   å†å²å³°å€¼          â”‚ memory.max_usage_in_bytesâ”‚ memory.peak    â”‚
â”‚   å†…å­˜ä¿æŠ¤          â”‚ æ—                        â”‚ memory.min/low â”‚
â”‚   è¯¦ç»†ç»Ÿè®¡          â”‚ memory.stat              â”‚ memory.stat    â”‚
â”‚   äº‹ä»¶ç»Ÿè®¡          â”‚ æ—                        â”‚ memory.events  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. mem_cgroup å†…æ ¸ç»“æ„

### 3.1 æ ¸å¿ƒç»“æ„å®šä¹‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    mem_cgroup ç»“æ„                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   struct mem_cgroup {                                           â”‚
â”‚       struct cgroup_subsys_state css;   // åµŒå…¥åŸºç±»             â”‚
â”‚                                                                 â”‚
â”‚       // å†…å­˜è®¡æ•°å™¨ï¼ˆæ ¸å¿ƒï¼‰                                     â”‚
â”‚       struct page_counter memory;       // ç‰©ç†å†…å­˜è®¡æ•°         â”‚
â”‚       struct page_counter swap;         // swap è®¡æ•°            â”‚
â”‚       struct page_counter memsw;        // å†…å­˜+swap è®¡æ•°       â”‚
â”‚       struct page_counter kmem;         // å†…æ ¸å†…å­˜è®¡æ•°         â”‚
â”‚       struct page_counter tcpmem;       // TCP ç¼“å†²åŒºè®¡æ•°       â”‚
â”‚                                                                 â”‚
â”‚       // é™åˆ¶å€¼                                                 â”‚
â”‚       unsigned long soft_limit;         // è½¯é™åˆ¶               â”‚
â”‚                                                                 â”‚
â”‚       // ç»Ÿè®¡ä¿¡æ¯                                               â”‚
â”‚       struct mem_cgroup_stat_cpu *stat; // per-CPU ç»Ÿè®¡         â”‚
â”‚                                                                 â”‚
â”‚       // OOM ç›¸å…³                                               â”‚
â”‚       bool oom_lock;                    // OOM é”               â”‚
â”‚       int oom_kill_disable;             // ç¦ç”¨ OOM killer      â”‚
â”‚                                                                 â”‚
â”‚       // LRU é“¾è¡¨ï¼ˆç”¨äºå†…å­˜å›æ”¶ï¼‰                               â”‚
â”‚       struct mem_cgroup_lruvec lruvec;                          â”‚
â”‚       ...                                                       â”‚
â”‚   };                                                            â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 page_counter è®¡æ•°å™¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    page_counter ç»“æ„                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   struct page_counter {                                         â”‚
â”‚       atomic_long_t usage;      // å½“å‰ä½¿ç”¨é‡ï¼ˆé¡µæ•°ï¼‰           â”‚
â”‚       unsigned long max;        // æœ€å¤§é™åˆ¶ï¼ˆé¡µæ•°ï¼‰             â”‚
â”‚       unsigned long watermark;  // å†å²å³°å€¼                     â”‚
â”‚       unsigned long failcnt;    // è¶…é™å¤±è´¥æ¬¡æ•°                 â”‚
â”‚       struct page_counter *parent;  // çˆ¶è®¡æ•°å™¨ï¼ˆå±‚çº§ç»“æ„ï¼‰     â”‚
â”‚   };                                                            â”‚
â”‚                                                                 â”‚
â”‚   å±‚çº§å…³ç³»ï¼š                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   root mem_cgroup                                        â”‚  â”‚
â”‚   â”‚   â””â”€â”€ page_counter (max=æ— é™)                            â”‚  â”‚
â”‚   â”‚           â”‚                                              â”‚  â”‚
â”‚   â”‚           â†“ parent                                       â”‚  â”‚
â”‚   â”‚   child mem_cgroup                                       â”‚  â”‚
â”‚   â”‚   â””â”€â”€ page_counter (max=1GB)                             â”‚  â”‚
â”‚   â”‚           â”‚                                              â”‚  â”‚
â”‚   â”‚           â†“ parent                                       â”‚  â”‚
â”‚   â”‚   grandchild mem_cgroup                                  â”‚  â”‚
â”‚   â”‚   â””â”€â”€ page_counter (max=512MB)                           â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚   å­ cgroup çš„é™åˆ¶ä¸èƒ½è¶…è¿‡çˆ¶ cgroup                             â”‚
â”‚   å­ cgroup çš„ä½¿ç”¨é‡ä¼šç´¯åŠ åˆ°çˆ¶ cgroup                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 å†…å­˜è®¡è´¹æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å†…å­˜åˆ†é…æ—¶çš„è®¡è´¹æµç¨‹                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   è¿›ç¨‹ç”³è¯·å†…å­˜                                                  â”‚
â”‚        â”‚                                                        â”‚
â”‚        â†“                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 1. æ‰¾åˆ°è¿›ç¨‹æ‰€å±çš„ mem_cgroup                             â”‚  â”‚
â”‚   â”‚    task->cgroups->subsys[memory_id] â†’ mem_cgroup         â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                        â”‚
â”‚        â†“                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 2. å°è¯•å¢åŠ  page_counter                                 â”‚  â”‚
â”‚   â”‚    page_counter_try_charge(&memcg->memory, nr_pages)     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                        â”‚
â”‚        â†“                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 3. æ£€æŸ¥æ˜¯å¦è¶…é™                                          â”‚  â”‚
â”‚   â”‚    if (usage + nr_pages > max)                           â”‚  â”‚
â”‚   â”‚        â†’ è§¦å‘å†…å­˜å›æ”¶                                    â”‚  â”‚
â”‚   â”‚        â†’ å›æ”¶å¤±è´¥åˆ™è§¦å‘ OOM                              â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                        â”‚
â”‚        â†“                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 4. å‘ä¸Šä¼ é€’è®¡è´¹ï¼ˆå±‚çº§ç»“æ„ï¼‰                              â”‚  â”‚
â”‚   â”‚    åŒæ—¶å¢åŠ çˆ¶ cgroup çš„ usage                            â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                        â”‚
â”‚        â†“                                                        â”‚
â”‚   åˆ†é…æˆåŠŸ / OOM                                                â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. å†…å­˜é™åˆ¶é…ç½®

### 4.1 Cgroup v1 é…ç½®

```bash
# è®¾ç½®å†…å­˜ç¡¬é™åˆ¶ï¼ˆ1GBï¼‰
echo 1073741824 > /sys/fs/cgroup/memory/mygroup/memory.limit_in_bytes

# è®¾ç½®å†…å­˜è½¯é™åˆ¶ï¼ˆ512MBï¼‰
echo 536870912 > /sys/fs/cgroup/memory/mygroup/memory.soft_limit_in_bytes

# è®¾ç½®å†…å­˜+swap é™åˆ¶ï¼ˆ2GBï¼‰
echo 2147483648 > /sys/fs/cgroup/memory/mygroup/memory.memsw.limit_in_bytes

# ç¦ç”¨ OOM killer
echo 1 > /sys/fs/cgroup/memory/mygroup/memory.oom_control

# å°†è¿›ç¨‹åŠ å…¥æ§åˆ¶ç»„
echo $PID > /sys/fs/cgroup/memory/mygroup/cgroup.procs
```

### 4.2 Cgroup v2 é…ç½®

```bash
# è®¾ç½®å†…å­˜ç¡¬é™åˆ¶ï¼ˆ1GBï¼‰
echo 1G > /sys/fs/cgroup/mygroup/memory.max

# è®¾ç½®å†…å­˜è½¯é™åˆ¶ï¼ˆ512MBï¼Œè¶…è¿‡ä¼šè§¦å‘å›æ”¶ï¼‰
echo 512M > /sys/fs/cgroup/mygroup/memory.high

# è®¾ç½®å†…å­˜ä¿æŠ¤ï¼ˆæœ€ä½ä¿è¯ 256MBï¼‰
echo 256M > /sys/fs/cgroup/mygroup/memory.min

# è®¾ç½® swap é™åˆ¶
echo 1G > /sys/fs/cgroup/mygroup/memory.swap.max

# å°†è¿›ç¨‹åŠ å…¥æ§åˆ¶ç»„
echo $PID > /sys/fs/cgroup/mygroup/cgroup.procs
```

### 4.3 é™åˆ¶ç±»å‹è¯´æ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å†…å­˜é™åˆ¶ç±»å‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   memory.maxï¼ˆç¡¬é™åˆ¶ï¼‰                                          â”‚
â”‚   â”œâ”€â”€ ç»å¯¹ä¸Šé™ï¼Œä¸èƒ½è¶…è¿‡                                        â”‚
â”‚   â”œâ”€â”€ è¶…è¿‡æ—¶è§¦å‘ OOM killer                                     â”‚
â”‚   â””â”€â”€ è®¾ç½®ä¸º "max" è¡¨ç¤ºä¸é™åˆ¶                                   â”‚
â”‚                                                                 â”‚
â”‚   memory.highï¼ˆè½¯é™åˆ¶ï¼‰                                         â”‚
â”‚   â”œâ”€â”€ è¶…è¿‡æ—¶è§¦å‘å†…å­˜å›æ”¶                                        â”‚
â”‚   â”œâ”€â”€ è¿›ç¨‹ä¼šè¢«é™æµï¼ˆthrottleï¼‰                                  â”‚
â”‚   â””â”€â”€ ä¸ä¼šè§¦å‘ OOM                                              â”‚
â”‚                                                                 â”‚
â”‚   memory.minï¼ˆç¡¬ä¿æŠ¤ï¼‰                                          â”‚
â”‚   â”œâ”€â”€ æœ€ä½å†…å­˜ä¿è¯                                              â”‚
â”‚   â”œâ”€â”€ ç³»ç»Ÿå†…å­˜ç´§å¼ æ—¶ä¹Ÿä¸ä¼šå›æ”¶è¿™éƒ¨åˆ†                            â”‚
â”‚   â””â”€â”€ ç”¨äºä¿æŠ¤å…³é”®è¿›ç¨‹                                          â”‚
â”‚                                                                 â”‚
â”‚   memory.lowï¼ˆè½¯ä¿æŠ¤ï¼‰                                          â”‚
â”‚   â”œâ”€â”€ å°½é‡ä¿è¯çš„å†…å­˜é‡                                          â”‚
â”‚   â”œâ”€â”€ ç³»ç»Ÿæåº¦ç´§å¼ æ—¶å¯èƒ½è¢«å›æ”¶                                  â”‚
â”‚   â””â”€â”€ ä¼˜å…ˆå›æ”¶å…¶ä»– cgroup çš„å†…å­˜                                â”‚
â”‚                                                                 â”‚
â”‚   å…³ç³»å›¾ï¼š                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  0        min       low       high      max             â”‚  â”‚
â”‚   â”‚  |---------|---------|---------|---------|              â”‚  â”‚
â”‚   â”‚  â”‚â† ç¡¬ä¿æŠ¤ â†’â”‚â† è½¯ä¿æŠ¤ â†’â”‚â† æ­£å¸¸åŒº â†’â”‚â† é™æµåŒº â†’â”‚â† OOM      â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ

### 5.1 æŸ¥çœ‹å½“å‰ä½¿ç”¨é‡

```bash
# Cgroup v1
cat /sys/fs/cgroup/memory/mygroup/memory.usage_in_bytes
# è¾“å‡ºï¼š52428800ï¼ˆå­—èŠ‚ï¼‰

# Cgroup v2
cat /sys/fs/cgroup/mygroup/memory.current
# è¾“å‡ºï¼š52428800ï¼ˆå­—èŠ‚ï¼‰

# æŸ¥çœ‹å†å²å³°å€¼
cat /sys/fs/cgroup/mygroup/memory.peak
```

### 5.2 æŸ¥çœ‹è¯¦ç»†ç»Ÿè®¡ï¼ˆmemory.statï¼‰

```bash
cat /sys/fs/cgroup/mygroup/memory.stat
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    memory.stat å­—æ®µè¯´æ˜                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   # åŒ¿åå†…å­˜ï¼ˆè¿›ç¨‹å †ã€æ ˆç­‰ï¼‰                                    â”‚
â”‚   anon                    52428800    # åŒ¿åé¡µå†…å­˜              â”‚
â”‚   anon_thp                0           # é€æ˜å¤§é¡µåŒ¿åå†…å­˜        â”‚
â”‚                                                                 â”‚
â”‚   # æ–‡ä»¶ç¼“å­˜                                                    â”‚
â”‚   file                    104857600   # æ–‡ä»¶é¡µç¼“å­˜              â”‚
â”‚   file_mapped             20971520    # æ˜ å°„çš„æ–‡ä»¶é¡µ            â”‚
â”‚   file_dirty              4096        # è„é¡µ                    â”‚
â”‚   file_writeback          0           # æ­£åœ¨å›å†™çš„é¡µ            â”‚
â”‚                                                                 â”‚
â”‚   # å†…æ ¸å†…å­˜                                                    â”‚
â”‚   kernel_stack            163840      # å†…æ ¸æ ˆ                  â”‚
â”‚   slab                    8388608     # slab åˆ†é…å™¨             â”‚
â”‚   sock                    0           # socket ç¼“å†²åŒº           â”‚
â”‚                                                                 â”‚
â”‚   # å…¶ä»–                                                        â”‚
â”‚   shmem                   0           # å…±äº«å†…å­˜                â”‚
â”‚   pgfault                 12345       # ç¼ºé¡µæ¬¡æ•°                â”‚
â”‚   pgmajfault              10          # ä¸»ç¼ºé¡µæ¬¡æ•°              â”‚
â”‚                                                                 â”‚
â”‚   # å†…å­˜äº‹ä»¶ï¼ˆv2ï¼‰                                              â”‚
â”‚   pgscan                  1000        # æ‰«æçš„é¡µæ•°              â”‚
â”‚   pgsteal                 500         # å›æ”¶çš„é¡µæ•°              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 æŸ¥çœ‹å†…å­˜äº‹ä»¶ï¼ˆv2ï¼‰

```bash
cat /sys/fs/cgroup/mygroup/memory.events
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    memory.events å­—æ®µè¯´æ˜                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   low 0           # è§¦å‘ memory.low ä¿æŠ¤çš„æ¬¡æ•°                  â”‚
â”‚   high 15         # è¶…è¿‡ memory.high è¢«é™æµçš„æ¬¡æ•°               â”‚
â”‚   max 3           # è¾¾åˆ° memory.max çš„æ¬¡æ•°                      â”‚
â”‚   oom 1           # è§¦å‘ OOM çš„æ¬¡æ•°                             â”‚
â”‚   oom_kill 1      # OOM æ€æ­»è¿›ç¨‹çš„æ¬¡æ•°                          â”‚
â”‚                                                                 â”‚
â”‚   è¿™äº›è®¡æ•°å™¨å¯¹äºç›‘æ§å’Œè°ƒä¼˜éå¸¸æœ‰ç”¨ï¼š                            â”‚
â”‚   â”œâ”€â”€ high é¢‘ç¹å¢åŠ  â†’ memory.high è®¾ç½®è¿‡ä½                      â”‚
â”‚   â”œâ”€â”€ max é¢‘ç¹å¢åŠ  â†’ å†…å­˜ä¸è¶³ï¼Œéœ€è¦å¢åŠ é™åˆ¶æˆ–ä¼˜åŒ–ç¨‹åº           â”‚
â”‚   â””â”€â”€ oom_kill > 0 â†’ å‘ç”Ÿè¿‡ OOMï¼Œéœ€è¦å…³æ³¨                       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.4 å®ç”¨ç›‘æ§è„šæœ¬

```bash
#!/bin/bash
# ç›‘æ§ cgroup å†…å­˜ä½¿ç”¨æƒ…å†µ

CGROUP_PATH="/sys/fs/cgroup/mygroup"

echo "=== Memory Cgroup ç›‘æ§ ==="
echo

# å½“å‰ä½¿ç”¨é‡
current=$(cat $CGROUP_PATH/memory.current)
max=$(cat $CGROUP_PATH/memory.max)
echo "å½“å‰ä½¿ç”¨: $(numfmt --to=iec $current)"
echo "ç¡¬é™åˆ¶:   $max"

# ä½¿ç”¨ç™¾åˆ†æ¯”
if [ "$max" != "max" ]; then
    percent=$((current * 100 / max))
    echo "ä½¿ç”¨ç‡:   ${percent}%"
fi

echo
echo "=== è¯¦ç»†ç»Ÿè®¡ ==="
echo "åŒ¿åå†…å­˜: $(grep ^anon $CGROUP_PATH/memory.stat | awk '{print $2}' | numfmt --to=iec)"
echo "æ–‡ä»¶ç¼“å­˜: $(grep ^file $CGROUP_PATH/memory.stat | head -1 | awk '{print $2}' | numfmt --to=iec)"

echo
echo "=== å†…å­˜äº‹ä»¶ ==="
cat $CGROUP_PATH/memory.events
```

### 5.5 å®¹å™¨ä¸­æŸ¥çœ‹å†…å­˜

```bash
# Docker å®¹å™¨çš„ cgroup è·¯å¾„
# v1: /sys/fs/cgroup/memory/docker/<container_id>/
# v2: /sys/fs/cgroup/system.slice/docker-<container_id>.scope/

# åœ¨å®¹å™¨å†…éƒ¨æŸ¥çœ‹ï¼ˆé€šè¿‡ /procï¼‰
cat /sys/fs/cgroup/memory.max        # v2
cat /sys/fs/cgroup/memory.current    # v2

# æˆ–ä½¿ç”¨ docker stats
docker stats <container_name>
```

---

*æŒç»­æ›´æ–°ä¸­...*
